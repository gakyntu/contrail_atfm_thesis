function [T] = temperature_standard_atmosphere(h,status)

% altitude h is to be expressed in km

switch status

    case 'ISA'

        T0=288.15;
        h11=11;
        T11=216.65;
        T=(h<=h11).*(T0-6.5*h)+T11.*(h>h11);

    case 'High-Latitude Summer'

        T=(h<=10).*(286.8374-4.7805.*h-0.1402.*h.^2) + (h>10).*(h<=23).*(225) + (h>23).*(h<=48).*(225*exp(0.008317.*(h-23))) + (h>48).*(h<=53).*277 + (h>53).*(h<=79).*(277-4.0769.*(h-53)) + (h>79).*(h<=100).*171;

    case 'High-Latitude Winter'

        T=(h<=8.5).*(257.4345+2.3474.*h-1.5479.*h.^2+0.08473.*h.^3) + (h>8.5).*(h<=30).*(217.5) + (h>30).*(h<=50).*(217.5+2.125*(h-30)) + (h>50).*(h<=54).*260 + (h>54).*(h<=100).*(260-1.667*(h-54));

    case 'Mid-Latitude Summer'

        T=(h<=13).*(294.9838-5.2159.*h-0.07109.*h.^2) + (h>13).*(h<=17).*(215.15) + (h>17).*(h<=47).*(215.15.*exp(0.008128*(h-17))) + (h>47).*(h<=53).*275 + (h>53).*(h<=80).*(275+(1-exp((h-53).*0.06))*20) + (h>80).*(h<=100).*175;

    case 'Mid-Latitude Winter'

        T=(h<=10).*(272.7241-3.6217.*h-0.1759.*h.^2) + (h>10).*(h<=33).*(218) + (h>33).*(h<=47).*(218+3.3571*(h-33)) + (h>47).*(h<=53).*265 + (h>53).*(h<=80).*(265-2.0370.*(h-53)) + (h>80).*(h<=100).*210;

    case 'Low-Latitude Annual'

        T=(h<=17).*(300.4222-6.3533.*h+0.005886.*h.^2) + (h>17).*(h<=47).*(194+(h-17).*2.533) + (h>47).*(h<=52).*270 + (h>52).*(h<=80).*(270-(h-52).*3.0714) + (h>80).*(h<=100).*184;

end
        

end
